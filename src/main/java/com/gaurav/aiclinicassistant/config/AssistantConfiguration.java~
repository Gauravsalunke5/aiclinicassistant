package com.gaurav.aiclinicassistant.config;

import com.gaurav.aiclinicassistant.assistant.AppointmentAssistant;
import com.gaurav.aiclinicassistant.assistant.DoctorAssistant;
import com.gaurav.aiclinicassistant.service.AppointmentService;
import com.gaurav.aiclinicassistant.service.DoctorService;
import dev.ai4j.openai4j.chat.Tool;
import dev.langchain4j.memory.ChatMemory;
import dev.langchain4j.memory.chat.MessageWindowChatMemory;
import dev.langchain4j.model.chat.ChatLanguageModel;
import dev.langchain4j.service.AiServices;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class AssistantConfiguration {

    @Bean
    ChatMemory chatMemory() {
        return MessageWindowChatMemory.withMaxMessages(20); // Adjust based on your requirements
    }


    @Bean
    public AppointmentAssistant appointmentAssistant(ChatLanguageModel model, AppointmentService appointmentService) {
        return AiServices.create(AppointmentAssistant.class, model, Tools.from(appointmentService));
    }

    @Bean
    public DoctorAssistant doctorAssistant(ChatLanguageModel model, DoctorService doctorService) {
        return AiServices.create(DoctorAssistant.class, model, Tool.from(doctorService));
    }
}
